<extend name="Common/form-ajax" />
<block name="form">
<tr>
    <th>权限列表:</th>
    <td>
        <ul id="CheckTree" class="ztree"></ul>
        <input type="hidden" name="rules" id="RulesValue" value="{$user_group}">
        <input type="hidden" name="id" value="{$id}">
    </td>
    
     <tr>
       	<th></th>
       	 	<td><input type="submit" id="btn_sub" class="btn-big btn-blue" value="授权"></td>
        </tr>
</tr>
</block>
<block name="extra">
<link rel="stylesheet" href="__PUBLIC__/Vendor/Ztree/css/zTreeStyle/zTreeStyle.css" type="text/css">

  <script type="text/javascript" src="__PUBLIC__/Vendor/Ztree/jquery.ztree.all-3.5.min.js"></script>
  <script type="text/javascript">
	  var setting = {
	        check: {enable: true},
	        data:{
	            simpleData: {enable: true},
	        },
	        callback:{
                onCheck:onCheck
            }
	    };
	    var zNodes = {$node};
	    var tree = $.fn.zTree.init($("#CheckTree"), setting, zNodes);
	    
	    function onCheck(e,treeId,treeNode){
	        var node = tree.getCheckedNodes(true);
	        var data='';
	        for (var i = 0; i < node.length; i++) {
	            data += node[i].id+',';
	        }
	        data=data.substr(0,data.length-1);
	        $('#RulesValue').val(data);
		 }
  
</script>
</block>
